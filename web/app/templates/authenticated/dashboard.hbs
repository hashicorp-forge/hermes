{{page-title "Dashboard"}}

<Header />

<section class="x-container">

  <Dashboard::NewFeaturesBanner />
  <div class="mb-6">
    <h1 class="text-display-500">
      Welcome back,
      {{this.authenticatedUser.info.given_name}}!
    </h1>
  </div>

  <div class="mt-8 flex gap-14 w-full">
    <div
      class="pb-10 w-full overflow-hidden border-r border-r-color-border-faint"
    >
      {{#if @modXel}}
        <Dashboard::DocsAwaitingReview @docs={{@model}} />
        <div
          class="w-full h-px border-t border-dashed border-t-color-border-faint -mt-1 mb-5"
        />
      {{/if}}

      {{#if this.recentDocs.all}}
        <div class="flex items-center gap-2.5 mb-1.5">
          <FlightIcon
            @name="bulb"
            class="-mt-px text-color-foreground-Xfaint"
          />
          <h2 class="text-body-300 font-regular">
            {{if @mXodel "L" "Here‘s the l"}}atest @ HashiCorp
          </h2>
        </div>
        <ol>
          {{#each this.recentDocs.doubleAllRandomized as |r|}}
            <li
              class="border-t border-t-color-border-faint first:border-t-0 pt-6 pb-7 pr-6 pl-2 hover:bg-color-surface-faint"
            >

              <div class="flex justify-between gap-6">
                <div class="shrink-0 relative -mt-1">
                  <Doc::Thumbnail
                    @status={{r.doc.status}}
                    @product={{r.doc.product}}
                    class="shrink-0 self-start medium -mt-1"
                  />
                </div>
                <div class="w-full">
                  <div class="flex w-full items-start justify-between mb-0.5">
                    <div
                      class="text-body-200 leading-none gap-2 flex text-color-foreground-faint"
                    >
                      <span>
                        {{r.doc.docType}}
                      </span>
                      <span class="opacity-50">
                        |
                      </span>
                      <span>
                        {{r.doc.docNumber}}
                      </span>
                      <span class="opacity-50">
                        |
                      </span>
                      <span>
                        {{r.doc.product}}
                      </span>
                    </div>
                    <div>
                      <Doc::State @state="In-Review" @hideProgress={{true}} />
                    </div>
                  </div>
                  <h3
                    class="text-color-foreground-strong text-display-300 font-semibold"
                  >
                    {{r.doc.title}}
                  </h3>
                  {{#if r.doc.summary}}
                    <p class="text-body-200 mt-1 max-w-[470px]">
                      {{r.doc.summary}}
                    </p>
                  {{/if}}
                  <div class="flex w-full items-center justify-between">
                    <div class="flex gap-2 mt-4 items-center text-body-200">
                      <Person::Avatar
                        @size="small"
                        @email={{get r.doc.owners 0}}
                        @imgURL={{get r.doc.ownerPhotos 0}}
                        class="-ml-px"
                      />
                      <span class="text-color-foreground-strong">
                        {{get r.doc.owners 0}}
                      </span>
                      <span class="text-color-foreground-faint">

                        {{time-ago r.doc.createdTime}}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          {{/each}}
        </ol>
      {{else if this.recentDocs.fetchAll.isRunning}}
        <div class="h-[100px]">
          <FlightIcon @name="loading" class="mt-1" />
        </div>
      {{else if (eq this.recentDocs.all null)}}
        <div class="h-[100px]">
          <p class="mb-7 text-body-300 text-color-foreground-faint">
            Error fetching documents.
          </p>
          <Hds::Button
            @text="Retry"
            @color="secondary"
            @size="small"
            @icon="reload"
            {{on "click" (perform this.recentDocs.fetchAll)}}
          />
        </div>
      {{else}}
        <div class="text-display-200">
          You havenʼt viewed any documents yet.
        </div>
      {{/if}}

    </div>

    <div class="shrink-0 w-64 gap-8 flex flex-col">
      <div>
        <h2 class="hermes-h4 flex items-center h-4">
          Pinned
        </h2>
        {{#if true}}
          <ul class="flex flex-col mt-1">

            <li class="flex gap-3 items-start py-3.5">
              <div class="w-full">
                <div class="flex items-start justify-between">
                  <h4 class="mb-1">Listbox Rollout (Ember)</h4>

                </div>
                <div class="flex items-center justify-between">
                  <div class="flex gap-0.5">
                    <div class="flex items-center gap-1">
                      <FlightIcon @name="square-fill" class="text-lime-600" />
                      <p class="text-body-100 text-color-foreground-faint">
                        HERMES-045
                      </p>
                    </div>
                  </div>
                  <div class="flex items-center gap-1">
                    <FlightIcon
                      @name="files"
                      class="text-color-foreground-faint"
                    />
                    2
                  </div>
                </div>
                {{! <FlightIcon
                    @name="chevrons-up"
                    class="text-color-foreground-critical"
                  /> }}
              </div>
            </li>
            <li
              class="flex gap-3 items-start py-3.5 border-t border-t-color-border-faint"
            >
              <div class="overflow-hidden">
                <div class="flex gap-3 items-start">
                  <div class="overflow-hidden">
                    <h4 class="mb-1.5">Account synchronization API from HCP</h4>
                    <div class="flex items-center justify-between">
                      {{! <ProductAvatar @productArea="Labs" /> }}
                      <div class="flex overflow-hidden items-center gap-1.5">
                        <Person::Avatar
                          class="shrink-0"
                          @email="jeff.daley@hashicorp.com"
                          @imgURL="https://lh3.googleusercontent.com/a/ACg8ocJNv0AD-Ppm6Y_fllZqE_h-sInH67hPyXjCbt97f1KG2A=s100"
                        />
                        <TruncatedText>

                          jeff.daley@hashicorp.com
                        </TruncatedText>
                      </div>
                      <div class="shrink-0 ml-1">
                        <Doc::State @state="Draft" @hideProgress={{true}} />
                      </div>
                    </div>
                  </div>
                  <div class="w-X5 flex justify-center shrink-0">
                    {{! <FlightIcon
                  @name="file-text"
                  class="text-color-foreground-faint"
                /> }}
                    <Doc::Thumbnail @product="Vagrant" class="" />
                  </div>
                </div>
              </div>
            </li>
          </ul>
        {{else}}
          <div class="text-color-foreground-faint mt-3 mb-2">
            <FlightIcon @name="pin" class="relative translate-y-0.5 mr-1.5" />
            None yet
          </div>
        {{/if}}
      </div>

      <div>
        <h2 class="hermes-h4 flex items-center h-6 mb-3">
          Recently viewed
        </h2>
        <ol class="grid gap-1">
          {{#each this.recentDocs.all as |r|}}
            <li class="overflow-hidden">
              <div class="flex justify-between gap-6">
                <div class="flex items-center mb-2 gap-2.5 overflow-hidden">
                  <ProductAvatar
                    @productArea={{r.doc.product}}
                    class="w-5 h-5 shrink-0"
                  />
                  {{! <div class="w-5 flex justify-center shrink-0">
                    <FlightIcon
                      @name="file-text"
                      class="text-color-foreground-faint"
                    />
                  </div> }}
                  <TruncatedText
                    @tagName="h3"
                    class="text-color-foreground-strong text-body-200"
                  >
                    {{r.doc.title}}
                  </TruncatedText>
                </div>
              </div>
            </li>
          {{/each}}

          {{! DUPLICATE }}
          {{#each (take 2 this.recentDocs.all) as |r|}}
            <li class="overflow-hidden">
              <div class="flex justify-between gap-6">
                <div class="flex items-center mb-2 gap-2 overflow-hidden">
                  <div class="w-5 flex justify-center shrink-0">
                    <FlightIcon
                      @name="grid"
                      class="text-color-foreground-faint"
                    />
                  </div>
                  <TruncatedText
                    @tagName="h3"
                    class="text-color-foreground-strong text-body-200"
                  >
                    {{r.doc.title}}
                  </TruncatedText>
                </div>
              </div>
            </li>
          {{/each}}
          <li class="overflow-hidden">
            <div class="flex justify-between gap-6">
              <div class="flex items-center mb-2 gap-2 overflow-hidden">
                <ProductAvatar
                  @productArea={{r.doc.product}}
                  class="w-5 h-5 shrink-0"
                />
                {{! <div class="w-5 flex justify-center shrink-0">
                  <FlightIcon
                    @name="file-text"
                    class="text-color-foreground-faint"
                  />
                </div> }}
                <TruncatedText
                  @tagName="h3"
                  class="text-color-foreground-strong text-body-200"
                >
                  TFC and HCP Unification - High Assurance Enablement
                </TruncatedText>
              </div>
            </div>
          </li>
          {{! /DUPLICATE }}
        </ol>
      </div>
    </div>

  </div>

</section>
