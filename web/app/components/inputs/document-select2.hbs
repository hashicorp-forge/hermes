<div class="hds-typography-body-100 hds-foreground-faint">
  Related docs
</div>
<div class="relative z-10">
  <Hds::Form::TextInput::Base
    @type="text"
    @value={{this.inputValue}}
    {{did-insert this.registerPopoverTrigger}}
    {{on "input" (perform this.search)}}
    {{on "input" this.onInput}}
    {{on "keydown" this.onKeydown}}
    {{on "focusin" this.onInputFocusin}}
    class="!pr-20 truncate"
    placeholder="---"
  />
  {{#if this.popoverIsShown}}
    <div
      class="absolute -bottom-0.5 translate-y-full w-full border min-h-[48px] rounded-md border-color-border-strong bg-white"
      {{dismissible dismiss=this.hidePopover related=this.popoverTrigger}}
    >

      {{#if this.userHasSearched}}
        {{#if this.inputValueIsValid}}
          <div class="bg-yellow-50 p-2.5">

            {{#if this.fetchURLInfo.isRunning}}
              <FlightIcon @name="loading" />
            {{else}}
              <div class="flex w-full justify-between">
                <div class="flex items-center w-full">

                  <img src={{this.faviconURL}} width="16" height="16" class="mr-2.5" />
                  <span class="font-bold truncate">

                    There will be a title here
                  </span>
                </div>
                <Hds::Button
                  @text="Add"
                  @color="secondary"
                  @size="small"
                  class="shrink-0 ml-12"
                  {{on "click" this.maybeAddResource}}
                />
              </div>
            {{/if}}
          </div>
        {{else if this.shownDocuments}}
          <ul>
            {{#each this.shownDocuments as |d|}}
              <li>
                <Action class="w-full">
                  {{! this needs to not be a link-to }}
                  <Doc::Inline
                    @avatar={{get d.ownerPhotos 0}}
                    @docID={{d.objectID}}
                    @docNumber={{d.docNumber}}
                    @isResult={{true}}
                    @owner={{get d.owners 0}}
                    @productArea={{d.product}}
                    @status={{d.status}}
                    @title={{d.title}}
                  />
                </Action>
              </li>
            {{/each}}
          </ul>
        {{else if this.search.isRunning}}
          Searching...
        {{else}}
          Invalid input
        {{/if}}
      {{else}}
        <div class="w-full p-3">
          <div class="flex text-color-foreground-faint">
            <FlightIcon @name="corner-left-up" class="mr-2" />
            Paste a URL or search for documents...
          </div>
        </div>
      {{/if}}
    </div>
  {{/if}}
</div>
<div class="mt-1">

{{#each this.relatedResources as |resource|}}
  <Document::RelatedResourcesListItem
    @resource={{resource}}
    @removeResource={{this.removeResource}}
  />
{{/each}}
</div>
