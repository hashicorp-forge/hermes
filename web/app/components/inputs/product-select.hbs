{{!  https://www.w3.org/WAI/ARIA/apg/patterns/combobox/examples/combobox-select-only/ }}
{{#if this.products}}
  <X::Hds::DropdownList
    @items={{this.products}}
    @listIsOrdered={{true}}
    @onItemClick={{this.onChange}}
    @selected={{@selected}}
    class="max-h-[320px] w-80"
  >
    <:anchor as |d|>
      <Action
        {{did-insert d.floatingUI.registerAnchor}}
        {{on "keydown" (fn d.onTriggerKeydown d.floatingUI)}}
        {{on "click" d.floatingUI.toggleContent}}
        aria-haspopup="listbox"
        aria-controls="x-hds-dropdown-list-{{if
          d.inputIsShown
          'container'
          'list'
        }}-{{d.floatingUI.id}}"
        class="relative flex"
      >
        <Hds::Badge
          class="hds-badge-dropdown"
          @text={{this.selected}}
          @icon={{get-product-id this.selected}}
        />
        <FlightIcon
          class="dropdown-caret"
          @name={{if f.contentIsShown "chevron-up" "chevron-down"}}
        />
      </Action>
    </:anchor>
    <:item as |i|>
      <Action
        {{did-insert i.registerElement}}
        {{on "mouseenter" i.focusMouseTarget}}
        {{on "click" i.onClick}}
        role={{i.role}}
        aria-selected={{i.isAriaSelected}}
        tabindex="-1"
        aria-checked={{i.selected}}
        class="x-hds-dropdown-list-item-link
          {{if i.isAriaSelected 'is-aria-selected'}}"
      >
        <X::Hds::DropdownList::CheckableItem
          @selected={{i.selected}}
          @value={{i.value}}
          @count={{i.count}}
        />
      </Action>
    </:item>
  </X::Hds::DropdownList>
{{else if this.fetchProducts.isRunning}}
  <FlightIcon @name="loading" />
{{else}}
  <div
    class="absolute top-0 left-0"
    {{did-insert (perform this.fetchProducts)}}
  ></div>
{{/if}}
