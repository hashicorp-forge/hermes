<PowerSelectMultiple
  data-test-people-select
  class="hds-form-field__control multiselect w-full"
  @searchEnabled={{true}}
  @search={{perform this.searchDirectory}}
  @searchField="email"
  @options={{this.options}}
  @selected={{@selected}}
  @renderInPlace={{@renderInPlace}}
  @placeholder="Search by name or email..."
  @onChange={{@onChange}}
  @onInput={{this.onInput}}
  @onClose={{this.onClose}}
  @onKeydown={{this.onKeydown}}
  @onFocus={{this.onFocus}}
  @disabled={{@disabled}}
  @searchMessage=""
  @selectedItemComponent={{component "multiselect/user-email-image-chip"}}
  @calculatePosition={{this.calculatePosition}}
  @loadingMessage="Loading..."
  @eventType="click"
  {{on "click" this.onClick}}
  ...attributes
  as |person|
>
  <div class="flex items-center gap-2 overflow-hidden py-1">
    {{! TODO: if (eq person.type "group") }}
    {{! show an affordance or label }}
    {{! anything we do here should also be accessible via the image chip }}
    <Person::Avatar @email={{person.email}} />
    <div class="w-full min-w-0">
      <TruncatedText
        class="text-body-200 leading-tight text-color-foreground-primary"
      >
        {{get-model-attr "person.name" person.email}}
        <span class="ml-0.5 text-body-100 text-color-foreground-disabled">
          {{person.email}}
        </span>
      </TruncatedText>
    </div>
  </div>
</PowerSelectMultiple>
