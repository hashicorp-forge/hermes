{{#if this.docIsBeingCreated}}
  <div class="hds-typography-display-400 mt-3 text-center">
    <FlightIcon @name="loading" @size="24" />
    <div class="mt-8 text-display-200 font-semibold">
      Creating
      {{@docType}}
      draft...
    </div>
    <div class="text-body-200 text-color-foreground-faint">This usually takes
      10-20 seconds.</div>
  </div>
{{else}}
  <form
    class="mx-auto max-w-xl"
    {{on "submit" this.submit}}
    {{did-insert this.registerForm}}
  >
    <div>
      <div class="space-y-4">
        <h1
          class="hds-typography-display-500 hds-font-weight-bold hds-foreground-strong"
        >
          New document
        </h1>
      </div>
      <div class="space-y-7 pt-8">

        {{! Title }}
        <Hds::Form::TextInput::Field
          @isRequired={{true}}
          @value={{this.title}}
          @type="text"
          name="title"
          {{on "input" this.updateForm}}
          as |F|
        >
          <F.Label class="relative">
            Title
          </F.Label>
          {{! <F.HelperText>
            A succinct outline of the idea you ºre proposing.
          </F.HelperText> }}
        </Hds::Form::TextInput::Field>

        {{! Summary }}
        <div class="relative">
          <Hds::Form::Textarea::Field
            @value={{this.summary}}
            rows="3"
            name="summary"
            {{on "input" this.updateForm}}
            as |F|
          >
            <F.Label>Summary</F.Label>
            <F.HelperText>
              <span
                class={{if
                  this.summaryIsLong
                  "bg-color-surface-warning text-color-foreground-warning-on-surface transition-colors"
                }}
              >One or two sentences</span>
              outlining your doc.
              {{if this.summaryIsLong "(Just a recommendation)"}}
            </F.HelperText>
          </Hds::Form::Textarea::Field>
        </div>

        {{! Type/Area }}
        <div class="grid grid-cols-2 gap-6">
          <div>
            <X::DropdownList
              class="product-select-dropdown-list"
              @items={{this.docTypes}}
              @selected={{this.docType}}
              @matchAnchorWidth={{true}}
              {{!-- @onItemClick={{this.onChange}} --}}
              {{!-- @placement={{@placement}} --}}
              {{!-- @isSaving={{@isSaving}} --}}
              {{!-- @renderOut={{@renderOut}} --}}
              {{! ...attributes }}
            >
              <:anchor as |dd|>
                <div class="mb-2 flex items-center justify-between">
                  <div class="flex items-center">
                    <label class="hermes-form-label relative">
                      Document type
                    </label>
                    <Hds::Badge @text="Required" @size="small" class="ml-1.5" />
                    <Action
                      {{on "click" this.showDocTypeModal}}
                      class="ml-1.5 flex text-color-foreground-faint opacity-75 hover:opacity-100"
                    >
                      <FlightIcon @name="info-fill" class="" />
                    </Action>
                  </div>
                </div>
                <dd.ToggleAction
                  class="x-dropdown-list-toggle-select product-select-default-toggle hds-button hds-button--color-secondary hds-button--size-medium w-full"
                >
                  <FlightIcon
                    @name={{or dd.selected.icon "file-text"}}
                    class="mr-3"
                  />
                  <div
                    class={{unless
                      dd.selected.longName
                      "text-color-foreground-faint"
                    }}
                  >
                    {{or dd.selected.longName "---"}}
                  </div>
                  {{#if dd.selected.shortName}}
                    <div class="ml-2 text-body-100 leading-none opacity-50">
                      {{dd.selected.shortName}}
                    </div>
                  {{/if}}
                  <FlightIcon
                    @name="caret"
                    class="product-select-toggle-caret"
                  />
                </dd.ToggleAction>
              </:anchor>
              <:item as |dd|>
                <dd.Action
                  class="pr-5"
                  {{on "click" (fn this.changeDocType dd.attrs.shortName)}}
                >
                  <div class="flex items-center">
                    <FlightIcon
                      @name={{or dd.attrs.icon "file-text"}}
                      class="mr-3"
                    />
                    {{dd.attrs.longName}}
                    <div class="ml-2 text-body-100 opacity-50">
                      {{dd.attrs.shortName}}
                    </div>
                  </div>
                </dd.Action>
              </:item>
            </X::DropdownList>
          </div>
          <div>
            <div class="mb-2">
              <span class="hermes-form-label relative">
                Product/Area
                <Hds::Badge @text="Required" @size="small" class="ml-1.5" />
              </span>
            </div>
            <Inputs::ProductSelect
              @selected={{this.productArea}}
              @onChange={{this.onProductSelect}}
              @isFullWidth={{true}}
            />
          </div>
        </div>

        {{! Contributors }}
        <Hds::Form::Field @layout="vertical" as |F|>
          <F.Control>
            <Inputs::PeopleSelect
              class="multiselect mt-2 w-full"
              @selected={{this.contributors}}
              @onChange={{this.updateContributors}}
            />
          </F.Control>
          <F.Label>
            Contributors
          </F.Label>
          {{#if this.formErrors.contributors}}
            <F.Error as |E|>
              <E.Message>{{this.formErrors.contributors}}</E.Message>
            </F.Error>
          {{/if}}
          <F.HelperText>
            People to share your doc with. You can always add more later.
          </F.HelperText>
        </Hds::Form::Field>
      </div>

      <Hds::Button
        @text="Create in Google Drive"
        type="submit"
        @icon="google"
        class="mt-10 mb-10"
      />
    </div>
    {{!-- <div>
      <div class="preview-card">
        <h3>
          <FlightIcon @name="eye" />
          Preview
        </h3>
        <Doc::Tile
          @productArea={{this.productArea}}
          @status="draft"
          @title={{this.title}}
          @owner={{this.authenticatedUser.info.email}}
        />
        <Hds::Button
          @text="Create {{@docType}} in Google Drive"
          type="submit"
          disabled={{not this.formRequirementsMet}}
          class="w-full"
        />
      </div>
    </div> --}}
  </form>
{{/if}}

{{#if this.docTypeModalIsShown}}
  <Hds::Modal @onClose={{this.hideDocTypeModal}} class="scrollable" as |M|>
    <M.Header>Document types</M.Header>
    <M.Body>
      <div class="scrollable-container max-h-[380px]">

        <ul class="mt-5 space-y-5">
          {{#each this.docTypes as |docType|}}
            <li>
              <div class="flex items-center">
                <h5 class="mb-0.5 flex text-display-200 font-semibold">
                  {{docType.longName}}
                  <span
                    class="ml-1.5 flex font-regular text-color-foreground-primary"
                  >
                    ({{docType.shortName}})
                  </span>
                </h5>
              </div>
              <p class="text-body-200">
                {{or docType.description "No description provided."}}
              </p>
              {{#if docType.moreInfoLink}}
                <ExternalLink
                  href={{docType.moreInfoLink.url}}
                  @iconIsShown={{true}}
                  class="mt-1 text-body-200 text-color-foreground-action"
                >
                  {{docType.moreInfoLink.text}}
                </ExternalLink>
              {{/if}}
            </li>
          {{/each}}
        </ul>
        <div
          class="sticky bottom-0 left-0 h-12 w-full bg-gradient-to-t from-white to-white/0"
        ></div>
      </div>
    </M.Body>

  </Hds::Modal>
{{/if}}
