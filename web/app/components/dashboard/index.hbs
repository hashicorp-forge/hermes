<Dashboard::NewFeaturesBanner />

<div class="mt-3 flex w-full">
  <div class="min-h-[500px] w-full overflow-hidden pb-20">
    <div class="main pr-4">

      <h4 data-test-welcome-message class="hermes-h4 mb-6">
        Welcome back,
        {{this.authenticatedUser.info.given_name}}!
      </h4>

      {{#if @docsAwaitingReview}}
        <Dashboard::DocsAwaitingReview @docs={{@docsAwaitingReview}} />
      {{/if}}

      <div class="flex items-center gap-3.5">
        <h2>
          Latest docs
        </h2>

        {{#if this.latestDocs.fetchAll.isRunning}}
          <FlightIcon @name="running" />
        {{/if}}
      </div>

      {{#if this.latestDocs.index.length}}
        <ol class="mt-5">
          {{#each this.latestDocs.index as |doc|}}
            <li class="group relative" data-test-latest-doc>
              <Doc::TileMedium @doc={{doc}} />
            </li>
          {{/each}}
        </ol>

        {{#if this.linkToAllDocsIsShown}}
          <div class="main-inner mt-5">
            <Hds::Button
              @color="secondary"
              @text="See older documents"
              @icon="arrow-right"
              @iconPosition="trailing"
              @isFullWidth={{true}}
              @route="authenticated.documents"
              @query={{hash page=2}}
              class="py-3"
            />
          </div>
        {{/if}}
      {{else}}
        <div data-test-no-docs-published class="empty-text">
          No documents have been published yet.
        </div>
        <Hds::Button
          data-test-new-document-button
          @route="authenticated.new"
          @text="New document"
          @icon="plus"
          class="mt-6 pl-2.5 pr-4"
        />
      {{/if}}
    </div>
  </div>

  <div class="secondary flex w-72 shrink-0 pt-10">
    <div class="relative h-full border-l border-l-color-border-primary pl-4">

      <div class="mt-2.5 flex w-full items-center justify-between pl-3">
        <h4 class="text-display-300 text-color-foreground-strong">
          Recently viewed
        </h4>
      </div>

      {{#if this.viewedDocs.all}}
        <ul class="mt-4">
          {{#each this.viewedDocs.all as |r|}}
            <li data-test-recently-viewed-doc>
              <LinkTo
                @route="authenticated.document"
                @model={{r.doc.objectID}}
                @query={{hash draft=r.doc.isDraft}}
                class="px-3 pt-3 pb-3.5"
              >
                <div class="flex w-full items-start gap-5">
                  <div class="w-full">
                    <div class="flex items-center gap-[3px]">
                      <Product::Avatar @product={{r.doc.product}} />
                      <Person::Avatar
                        @email="{{get r.doc.owners 0}}"
                        @imgURL={{get r.doc.ownerPhotos 0}}
                      />
                      <Hds::Badge
                        @text={{r.doc.docType}}
                        class="h-5 px-1.5 py-0"
                      />
                    </div>
                    <h5 class="mt-1.5">
                      {{r.doc.title}}
                      <span class="ml-0.5 text-body-100 font-regular">

                        {{r.doc.docNumber}}
                      </span>
                    </h5>
                    <p class="mt-0.5 text-body-100 text-color-foreground-faint">
                      Modified
                      {{time-ago r.doc.modifiedTime}}
                    </p>
                  </div>
                </div>
              </LinkTo>
            </li>
          {{/each}}
        </ul>
      {{else}}
        <div data-test-no-viewed-docs class="empty-text px-3">
          You haven't viewed any documents yet.
        </div>
      {{/if}}
    </div>
  </div>
</div>
